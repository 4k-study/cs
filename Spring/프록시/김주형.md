# 프록시

타겟 객체와 같은 인터페이스 타입이나, 타겟 객체를 상속한 대리(proxy) 객체를 사용하여, 
타겟 객체의 코드를 수정 하지 않고도, 기능을 추가할 수 있도록 하는 패턴

# 스프링에서 프록시

- 싱글톤 의존 관계 주입
- 선언적 트랜잭션
- AOP 구현

# 스프링 구현 방식

## JDK dynamic proxy

- reflection api를 이용해 타겟 객체가 구현한 인터페이스 
기반으로 런타임에 동적으로 프록시 객체를 만들어 준다.
- 인터페이스를 구현한 클래스가 아니면 프록시 객체를 생성할 수 없다.
    
    → 프록시를 적용하기 위해서는 반드시 인터페이스를 만들어야 한다.
    
- 구체 클래스로 빈을 주입 받을 수 없고, 반드시 인터페이스로만 주입받아야 한다.

## CGLib proxy

- 런타임에 바이트 코드를 조작하기 때문에, 구체 클래스와 인터페이스를 통한 주입 모두 가능하다.
- 상속을 이용하기 때문에, 기본 생성자가 2번 호출되고 final 클래스나 final 메서드이면 안된다는 제약이 있다.
    - 스프링 3.2부터 이를 내장시켰다.
    - 스프링 4.0부터 objenesis라는 특별한 라이브러리를 사용해 기본 생성자 없이 객체 생성이 가능하도록 해서, 생성자가 2번 호출되는 문제 역시 해결하였다.
- Spring Boot는 기본적으로 CGLib를 이용해서 proxy를 생성한다.
