# 샤딩

- 대규모 데이터베이스를 여러 개의 작은 데이터베이스로 분산하여 저장하는 기법이다.
이때, 나누어진 작은 데이터베이스를 샤드라고 부른다.
- 각각의 작은 데이터베이스는 논리적으로 하나의 데이터베이스로 관리되지만, 
실제로는 분산된 서버에 데이터를 저장하고, 처리한다.

# 장점

1. 확장성
샤딩은 대규모 데이터베이스 환경에서 높은 확장성을 제공합니다. 
데이터베이스가 샤딩되면, 데이터베이스의 일부만을 처리할 수 있는 
작은 서버를 사용하여 대규모 데이터를 처리할 수 있습니다.
2. 높은 처리 성능
샤딩은 대규모 트래픽을 처리할 수 있으며, 
다수의 물리적 데이터베이스 서버를 사용하므로 높은 처리 성능을 제공한다.
3. 장애 대응 능력
샤딩은 데이터베이스의 일부만을 처리하는 서버를 사용하므로, 전체 데이터베이스가 고장나는 것보다는 일부 샤드가 고장나는 경우가 많다. 
이런 경우에도 다른 샤드에서 데이터를 읽어올 수 있으므로 전체 시스템이 중단되지 않는다.
4. 지역성(Locality)
샤딩은 데이터를 지역적으로 분산시킬 수 있으므로, 지역성을 고려한 데이터 처리를 구현할 수 있다. 
지역별로 다른 데이터를 처리해야 하는 서비스의 경우, 샤딩을 사용하여 지역별 데이터를 분산 처리할 수 있다.
5. 저렴한 비용
샤딩은 여러 개의 작은 데이터베이스 서버를 사용하여 처리하므로, 
대규모 데이터베이스 서버를 사용하는 것보다 비용이 저렴하다.
6. 확장성을 위한 데이터 이동성
샤딩을 사용하여 데이터를 분산시키면, 데이터 이동성을 갖추게 된다. 
데이터를 이동시켜야 할 경우, 데이터를 이동시키는 것이 가능해지므로, 
새로운 샤드를 추가하거나, 기존 샤드를 제거하는 등의 데이터베이스 확장성을 유지하는 작업이 가능하다.

# 단점

1. 복잡성 증가
샤딩은 복잡한 데이터베이스 아키텍처를 필요로 하여, 관리와 유지보수가 어려울 수 있다. 
데이터를 분산시키는 작업이 복잡하고, 이를 관리하고 모니터링하기 위한 별도의 시스템을 구축해야 한다.
2. 데이터 불일치 문제
샤딩된 데이터베이스에서는 동일한 데이터가 여러 샤드에 저장된다. 
이로 인해 각 샤드에서 동일한 데이터를 다른 방식으로 처리할 수 있으므로, 
데이터 불일치 문제가 발생할 수 있다.
3. 조인 연산의 어려움
샤딩된 데이터베이스에서는 다른 샤드에 저장된 데이터를 사용하여 조인 연산을 수행할 수 없다. 이를 위해서는 추가적인 작업이 필요하며, 이는 성능에 영향을 미칠 수 있다.
4. 트랜잭션 처리의 어려움
샤딩된 데이터베이스에서는 다수의 샤드에 걸쳐 트랜잭션 처리를 수행할 수 없다. 
따라서, 트랜잭션 처리를 위한 별도의 작업이 필요하다.
5. 샤드 간 통신의 부담
샤딩된 데이터베이스에서는 다수의 샤드 간에 데이터를 이동해야 하므로, 샤드 간 통신의 부담이 존재합니다. 이는 데이터 이동성을 유지하기 위한 작업으로 인해 발생할 수 있다.
6. 분산된 데이터 처리의 어려움
샤딩된 데이터베이스에서는 데이터가 분산되므로, 데이터 처리와 관련된 작업이 어려울 수 있다. 예를 들어, 데이터 검색 작업이 모든 샤드에 걸쳐 수행되어야 하는 경우, 이에 대한 별도의 작업이 필요하다.

# 샤딩 방법

## 모듈러 샤딩

- PK를 모듈러 연산을 통해 샤하는 방법
- 데이터량이 일정 수준으로 유지될 것으로 예산되는 데이터 셋에 적합한 방법

### 장점

- 데이터가 균일하게 분산된다.
- 트래픽을 안정적으로 소화할 수 있어, DB리소스를 최대한 활용 가능

### 단점

- DB를 추가 증설하는 과정에서 이미 적재된 데이터의 재정렬이 필요하다.

## 레인지 샤딩

- 데이터를 특정 범위 기준으로 샤딩하는 방법
- 데이터가 급격하게 증가할 여지가 있는 데이터셋에 적합하다.

### 장점

- DB 증설에 따른 재정렬 비용이 들지 않는다.

### 단점

- 일부 DB에 데이터가 몰릴 수 있다.
