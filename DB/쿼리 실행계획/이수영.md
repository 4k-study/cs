# 쿼리 실행계획이란?

쿼리 실행계획은 DBMS에서 어떤 SQL 쿼리를 실행하는데 사용하는 작업 단계를 의미합니다.

사용자가 SQL 쿼리를 DB로 보내면 옵티마이저는 쿼리 실행에 필요한 cost를 측정하고 쿼리를 실행하는 데 필요한 cost를 최소화하는 가장 효율적인 계획을 선택합니다.

### 왜 실행계획을 사용하는가?

실행계획을 사용하는 이유는 개발자가 쿼리 실행 계획을 확인함으로써 잠재적인 병목 현상 또는 비효율성을 확인할 수 있고 이를 통해서 성능 개선하는 조치를 취할 수 있다는 점에서 쿼리 최적화에서 핵심 부분이라 얘기할 수 있습니다.

### SQL 처리 과정

파싱 > 최적화 > 실행 과정

- 파싱
    - SQL 구문에 오류가 있는지, SQL을 실행해야 하는 대상 객체가 존재하는지 등을 검사합니다.
    - SQL 파서에서 SQL을 파싱해서 트리 형태로 만들게 됩니다.
- 최적화
    - 옵티마이저에서 파서 트리를 참고하여 cost를 계산하고 실행 계획을 수립합니다.
        - 이때 불필요한 조건의 제거 및 연산을 단순화하고
        - 여러 테이블의 조인이 있는 경우 어떤 순서로 테이블을 읽을 지 결정합니다.
        - 그리고 각 테이블에 사용된 조건과 인덱스 통계 정보를 이용해서 사용할 인덱스를 결정합니다.
        - 마지막으로 가져온 레코드들을 임시 테이블에 넣고 다시 한번 가공해야 하는 지를 결정하는 것과 같은 최적화가 이루어집니다.
    - 옵티마이저에 의한 SQL 최적화가 끝나면 실행 계획이 완성됩니다.
- 실행
    - 실행엔진에서 만들어진 실행 계획을 바탕으로 메모리 상에서 데이터를 읽거나 물리적인 공간에서 데이터를 로딩하는 등의 작업을 수행합니다.
