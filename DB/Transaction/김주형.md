# 트랜잭션

데이터 베이스 상태를 변화시키는, 논리적 작업의 최소 단위

## Commit

하나의 트랜잭션이 성공적으로 끝나고, DB가 일관성 있는 상태에 있을 때, 
그것을 db에 반영하기 위해 사용하는 연산 

## Rollback

트랜잭션이 비정상적으로 종료되어, 
트랜잭션의 원자성을 구현하기 위해, 수행했던 모든 연산을 취소하는 연산

# 특징

- 원자성 Atomity

트랜잭션으로 묶인 작업들은 DB에 모두 반영되거나, 전혀 반영되지 않아야 한다.

- 일관성 (Consistency)

트랜잭션을 처리한 후에도 데이터베이스는 일관된 상태를 유지해야 한다.

- 독립성(Isolation)

서로 다른 트랜잭션이 동시에 수행 될 때, 하나의 트랜잭션은 다른 트랜잭션에 영향을 받지 않는다.

- 지속성(Duability)

트랜잭션이 성공적으로 완료되었다면, 결과는 영구적으로 반영되어야 한다.

# 트랜잭션의 상태

- 활동(Active) : 트랜잭션이 실행중인 상태
- 부분 완료(Partially Committed) : 트랜잭션의 연산이 수행되고, Commit 되기 직전의 상태
- 완료 상태(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태
- 실패 상태(Failed) : 트랜잰션 실행 중 오류가 발생하여 중단된 상태
- 취소(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태

# 이상 현상

- Dirty Read : 한 트랜잭션이 데이터를 변경하고, 커밋하지 않은 데이터를 다른 트랜잭션에서 읽는 현상
- Non-Repeatable Read : 한 트랜잭션이 데이터를 읽고, 다른 트랜재션에서 그 데이터를 수정하여 한 트랜잭션 안에서 읽어온 데이터가 달라지는 현상
- Phantom Read : 한 트랜잭션이 데이터 목록을 조회하고, 다른 트랜잭션에서 데이터를 입력해서 전에 조회되지 않은 데이터가 추가로 조회되는 현상

# 트랜잭션 격리 수준

아래로 갈 수록, 격리 수준은 높아지지만, 성능이 떨어진다.

- Read-Uncommitted : 커밋 전의 트랜잭션의 수정 사항을 다른 트랜잭션에서 읽는 것을 허용
- Read-Committed : 커밋이 완료된 트랜잭션의 변경사항만 다른 트랜잭션에서 조회 가능
- Repeatable-Read : 트랜잭션 중 조회한 내용이 항상 동일함을 보장
- Serializable : 한 트랜잭션에서 사용하는 데이터를 다른 트랜잭션에서 접근 불가능 하도록 함
    - ACID 성질이 엄격하게 지켜지나, 성능은 가장 떨어짐
    - PHANTOM READ를 방지하기 위해 범위가 지정된 WHERE 절을 사용할 때 필요

|  | Dirty Read | Non Repeatable Read | Phantom Read |
| --- | --- | --- | --- |
| Read Uncommitted | O | O | O |
| Read committed |  | O | O |
| Repeatable Read |  |  | O |
| Serializable Read |  |  |  |
