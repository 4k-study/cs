# 영속성 컨텍스트

엔티티매니저에 의해 관리되는 엔티티들이 모여있는 환경을 뜻하는 논리적인 개념이다.

# 장점

- 1차 캐시 : 영속화된 엔티티를 메모리에 캐시하기 때문에, 불필요한 쿼리를 줄여 준다.
- 동일성 보장 : 같은 트랜잭션 안에서, 식별자가 같은 엔티티들의 동일성을 보장 해준다.
- 쓰기 지연 : 트랜잭션을 커밋하기 전 까지 쿼리를 지연시키고, 
커밋 하는 순간에 동기화 하기 때문에 네트워크 비용을 아낄 수 있다.
- 변경 감지 : 엔티티의 초기 스냅샷과 커밋하기 전 상태를 비교하여, 자동으로 변경을 감지하고, 데이터베이스에 반영해 준다.
- 지연 로딩 : 엔티티가 필요한 순간 데이터 베이스에 쿼리를 날린다.

# 단점

- 메모리 사용량 : 영속성 컨텍스트는 엔티티를 1차 캐시에 저장하기 때문에, 서버의 메모리를 사용 한다. 큰 규모의 애플리케이션에서 많은 수의 엔티티를 다룰 경우 메모리 사용량이 증가할 수 있다. 서버의 자원 사용에 영향을 줄 수 있으므로 적절한 메모리 관리가 필요하다.
- 데이터베이스 동기화 비용 : 영속성 컨텍스트는 트랜잭션을 커밋할 때 변경된 엔티티를 데이터베이스와 동기화한다. 이 때 모든 변경 내용을 데이터베이스에 반영해야 하므로 동기화 비용이 발생할 수 있다. 특히, 대량의 변경이 있는 경우 동기화 작업이 오래 걸릴 수 있다.
- 긴 생명주기 관리 : 영속성 컨텍스트는 트랜잭션 범위 내에서 생성되고 종료된다. 따라서 영속성 컨텍스트를 오랫동안 유지하는 경우, 메모리 누수와 같은 문제가 발생할 수 있다. 긴 생명주기를 가진 영속성 컨텍스트는 적절한 관리가 필요하며, 필요하지 않은 경우에는 적시에 종료되어야 한다.
- 복잡성과 학습 곡선 : 영속성 컨텍스트는 개념적으로 다소 복잡할 수 있으며, 영속성 컨텍스트와 관련된 기능과 설정을 올바르게 이해하고 사용하기 위해서는 학습과 경험이 필요하다.
