Q. 스프링 트랜잭션이 롤백되었을 시, JPA 의 1차 캐시에는 이미 데이터가 원본이랑 다르게 변경되어있을 터인데, 이를 원본으로 만들기 위해서 DB 와 동기화를 위한 조회 쿼리가 날아가나요?
```
아니오. 스프링 트랜잭션이 롤백되면 JPA의 1차 캐시는 원래 상태로 복원됩니다. 트랜잭션이 롤백되면 영속성 컨텍스트도 함께 롤백되어 1차 캐시의 모든 변경 사항이 취소됩니다. 이때 원래 상태는 스냅샷을 통해 보관하고 있습니다.
```

Q. 영속성 컨텍스트와 엔티티 매니저의 관계에 대해 설명해주세요
```
엔티티 매니저는 영속성 컨텍스트에 대한 접근을 제공하며, 영속성 컨텍스트를 생성하고 관리합니다.
엔티티 매니저를 통해 엔티티를 조회하거나 변경하면, 해당 엔티티는 영속성 컨텍스트에 관리되며, 영속성 컨텍스트 내에서 변경 사항이 추적됩니다.
엔티티 매니저를 통해 영속성 컨텍스트에 저장된 엔티티를 데이터베이스에 반영하는 flush 작업을 수행할 수 있습니다.
```

Q. 엔티티 매니저는 쓰레드 세이프 한가요? 스레드 세이프하게 하려면 어떻게 해야 하나요?
```
스레드 세이프하지 않습니다.

Spring Framework를 사용하면 스레드 세이프한 엔티티 매니저를 자동으로 관리할 수 있습니다.
Spring의 트랜잭션 관리 기능을 사용하면 트랜잭션 범위 내에서 엔티티 매니저가 자동으로 생성되고, 트랜잭션 종료 시 자동으로 해제됩니다.
이 방식을 사용하면 엔티티 매니저를 직접 생성하고 관리할 필요가 없으며, 편리하게 스레드 세이프한 환경을 구성할 수 있습니다.
```

Q. 영속성 컨텍스트는 1차 캐시와 같은 건가요?
```
1차 캐시는 영속성 컨텍스트의 핵심 기능 중 하나입니다.
```

Q. 영속성 컨텍스트 단점
```
메모리 사용량: 영속성 컨텍스트는 1차 캐시를 유지하기 위해 메모리를 사용합니다. 많은 수의 엔티티가 영속성 컨텍스트에 적재되면 메모리 사용량이 증가할 수 있습니다.
잠재적인 오류: 영속성 컨텍스트는 엔티티와 관련된 상태를 추적하고 변경을 동기화하기 위해 많은 내부 로직을 처리합니다. 이로 인해 잠재적인 오류가 발생할 수 있으며, 이를 제대로 처리하지 않으면 예기치 않은 동작이 발생할 수 있습니다.
```
