# SSL TLS

### SSL(Secure Sockets Layer)

SSL은 브라우저와 서버 사이의 보안을 위해 만들어졌다. 보안과 성능상의 이유로 두가지 암호화 기법을 혼용해서 사용하고 있다.

1996년 3.0 이후 버전이 나오지 않아 취약점이 존재한다.

### TLS(Transport Layer Security Protocol)

SSL의 업데이트 버전으로 SSL 3.0과 현재 TLS는 크게 다르지 않다. 사실상 명칭만 다르다

### 동작 방식

웹에서 전송되는 데이터를 암호화 하는데, 이를 서버와 클라이언트간 핸드셰이크와 디지털 서명을 통해 인증한다.

**핸드셰이크**

1. 클라이언트가 서버로 메세지를 전송하며 핸드셰이크 시작.
    
    TLS버전, 클라이언트가 가능한 암호화 알고리즘, 무작위 바이트 문자열 포함해서 전송
    
2. 서버가 응답으로 SSL인증서, 서버가 고른 암호화 알고리즘, 서버에서 생성한 무작위 바이트 문자열을 응답한다.
3. 클라이언트가 SSL 인증서를 발행 기관(CA)으로부터 검증한다.
이를 통해 실제 도메인 소유자인지 확인한다.
4. 클라이언트는 “예비 암호”라는 무작위 바이트 문자열을 전송한다. 이는 공개키로 암호화 되어있으며, 서버의 공개키로 암호화한다.(SSL인증서에 서버 공개키 포함)
5. 서버는 “예비 암호”를 서버의 개인키로 복호화한다.
6. 클라이언트와 서버가 (클라이언트 무작위 바이트 문자열, 서버 무작위 바이트 문자열, “예비 암호”)를 이용해 세션키(공개키)를 생성한다. 클라 - 서버 같은값이어야 한다.
7. 클라이언트는 세션키로 암호화된 완료 메세지를 전송한다.
8. 서버도 세션키로 암호화된 완료 메세지를 전송한다.
9. 핸드셰이크가 완료되고 세션키를 통해 통신을 진행한다.

### HTTPS 사용

1. A 서버에서 HTTPS를 적용하기 위해 공개키와 개인키 생성
2. CA 기업에 공개키 관리를 계약
3. CA 기업은 A 서버의 공개키, 해당 기업의 이름, 공개키 암호화 방법을 담은 인증서를 만들고 해당 인증서를 CA 기업의 개인키로 암호화해서 A 서버에게 제공
4. 1~3을 통해 A 서버는 직접적인 공개키가 아닌 암호화된 인증서를 보유
5. 클라이언트가 통신 요청을 보내면 SSL/TLS Handshake 과정을 수행하여 연결을 수립
6. 클라이언트와 A 서버와 통신을 시작
