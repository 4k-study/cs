## 데드락이란?

- 두 개 이상의 프로세스가 자원을 점유한 상태에서 서로 다른 프로세스가 점유한 자원을 요구하며, 서로의 작업이 끝나기를 기다리며 둘 다 영원히 끝나지 않는 상태

## 데드락의 발생 조건

데드락은 아래 4가지 조건이 모두 만족하는 경우 발생 가능성이 있음

하나라도 만족하지 않으면 발생하지 않음

- 상호 배제
    - 한 번에 한 개의 프로세스만이 공유 자원을 사용할 수 있음
- 점유 대기
    - 프로세스가 자원을 점유한 상태에서 다른 자원을 기다림
- 비선점
    - 프로세스가 작업을 마치고 자원을 자발적으로 반환할 때까지 기다림
        - 강제적으로 할당된 자원을 뺏을 수 없음을 의미함
- 순환 대기
    - 프로세스의 자원 점유 및 점유된 자원의 요구 관계가 원형을 이루면서 대기하는 조건.
        - 즉, 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있음

## 데드락 해결 방법

### 예방

데드락이 아예 일어나지 않도록 데드락의 발생 조건 중 하나를 부정하는 방법입니다.

- 상호 배제 부정
    - 여러 개의 프로세스가 동시에 공유 자원을 사용할 수 있게 함
- 점유 대기 부정
    - 프로세스가 실행되기 전에 필요한 모든 자원을 할당하여 자원을 기다리지 않게 하거나, 자원을 점유하지 않은 상태에서만 자원 요청을 받게 함
- 비선점 부정
    - 모든 자원에 대해 선점을 허용함
- 순환 대기 부정
    - 자원을 선형으로 분류하여 고유 번호를 할당하고, 각 프로세스는 현재 점유한 자원의 고유 번호의 앞이나 뒤 한쪽 방향으로만 자원을 요구하도록 함

다만 예방 방식은 시스템 처리량이나 자원 사용 효율이 떨어지는 단점이 있습니다.

### 회피

데드락이 발생할 수 있는 자원 할당을 하지 않고, 안전한 상태에서만 자원 요청을 허용하는 방법입니다. 다만, 회피 방식을 이용하기 위해서는 아래와 같은 가정이 필요합니다.

- 프로세스 수가 고정되어있음
- 자원의 종류와 수가 고정되어있음
- 프로세스가 요구하는 최대 자원의 수를 알아야 함
- 프로세스는 자원 사용 후 반드시 반납하는 것이 보장됨

### 탐지

시스템에 데드락이 발생했는지 탐지하고 회복 기법 알고리즘을 활용하는 것입니다.

지속적으로 데드락을 확인하는 작업이 필요하기에 성능 저하가 발생합니다.

### 회복

데드락이 발생했을 때 회복하는 기법을 의미합니다.

- 사용자 처리
    - 데드락에 있는 프로세스를 사용자가 강제 종료
- 시스템 처리
    - 프로세스 중지
        - 데드락에 있는 모든 프로세스 중지
        - 데드락이 해결될 때 까지 프로세스를 하나씩 중지
    - 자원 선점
        - 프로세스들로부터 자원을 빼앗아 데드락이 해결될 때까지 다른 프로세스들에게 할당
