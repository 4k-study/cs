## 프로세스

<aside>
💡 프로그램이 메모리 위에 적재되어 CPU에 의해 실행되는 것

</aside>

### 프로세스의 메모리 할당

프로세스는 메모리에 적재될 때 운영체제로부터 메모리를 할당받는데, 이 메모리를 **code, data, heap, stack** 영역으로 나눌 수 있다. 이 메모리 영역은 프로세스마다 별도로 할당받는다.

- **code** : 프로그램의 코드가 적재되는 영역. CPU가 이 영역의 코드를 읽어 프로세스가 실행된다.
- **data** : 전역변수, 정적변수가 저장되는 영역
- **heap** : 런타임 중에 메모리가 할당되는 동적 메모리가 할당되는 영역
- **stack** : 함수에서 사용되는 지역변수, 매개변수가 저장되는 영역

### CPU의 연산

CPU가 프로그램을 실행하려면 프로그램의 코드를 읽어야 하는데, 지금 어떤 코드를 읽어야 하는지는 CPU의 PC레지스터에 저장되어있다.

### 멀티프로세스

<aside>
💡 2개의 프로세스가 동시에 실행되는 것을 말한다. 이때 동시에라는 말에는 병렬성, 동시성 두 가지를 의미하는데, 동시성은 CPU의 core가 하나일 때 여러 프로세스를 번갈아 가면서 실행하는 시분할 시스템을 의미하고 병렬성은 CPU의 core가 여러 개일 때, 각각의 CPU core가 각각의 프로세스를 동시에 실행되는 것을 말한다.

</aside>

## 스레드

<aside>
💡 한 프로세스 내에서 실행되는 동작의 단위이다.

</aside>

### 멀티스레드

<aside>
💡 하나의 프로세스 내에서 여러 스레드가 동시에 작업을 수행하는 것을 말한다. 각 스레드는 속해있는 프로세스의 stack 영역, code 영역을 제외한 나머지 메모리 영역을 공유해서 사용한다.

</aside>

## 멀티프로세스 vs 멀티스레드

- 멀티스레드는 멀티프로세스보다 적은 메모리 공간을 사용하고 Context Switching이 더 빠르다.
    - 멀티스레드는 context switching 시 cache memory를 초기화할 필요가 없기 때문에
- 멀티스레드는 각 스레드들이 메모리 공간을 공유해서 사용하기 때문에 동기화 문제와 하나의 스레드에서의 장애가 다른 스레드에게까지 영향을 끼칠 수 있다.

## 멀티프로세스 환경에서의 데이터 공유

<aside>
💡 프로세스간에는 각각 독립된 메모리 영역을 할당받기 때문에 다른 프로세스의 메모리 공간을 참조할 수 없다. 하지만 운영체제는 프로세스간에 자원 접근을 위한 메커니즘인 IPC를 제공한다.

IPC 방법으로는 대표적으로 공유메모리, 메세지 전달 방식 등이 있다.

</aside>

### 공유메모리 방식

<aside>
💡 프로세스들이 메모리의 일부분을 공유하는 방식이다. 그리고 이 공유된 메모리 영역에 읽기/쓰기를 통해 데이터를 공유한다. 프로세스가 공유 메모리 할당을 커널에 요청하면 커널이 해당 프로세스에 메모리 공간을 할당해준다. 이후 해당 프로세스는 커널의 도움 없이 공유 메모리에 접근이 가능해진다. 따라서 처음을 제외하고 커널의 도움 없이 메모리에 접근할 수 있기 때문에 속도가 빠르다는 장점이 있다.

하지만 공유메모리 방식은 같은 메모리를 공유하기 때문에 데이터의 일관성, 동시성 문제가 발생할 수 있다는 단점이 있다.

</aside>

### 메세지 전달 방식

<aside>
💡 메세지 전달 방식은 시스템 콜을 통해 이루어진다. 커널을 통해 send와 receive라는 두 가지 연산을 제공받는데, 프로세스1이 커널로 메세지를 보내면 커널이 프로세스2에게 메세지를 전달하는 방식으로 동작한다. 

커널을 통해 데이터를 전달하기 때문에 공유메모리 방식보다는 속도가 느리다는 단점이 있지만 일관성 문제가 발생하지 않기 때문에 적은 양의 데이터를 전달할 때 유용하다.

파이프, 소켓, 메세지 큐 방식 등이 존재한다.

</aside>
